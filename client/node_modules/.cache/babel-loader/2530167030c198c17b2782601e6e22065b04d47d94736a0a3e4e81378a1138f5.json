{"ast":null,"code":"var _jsxFileName = \"D:\\\\jisu\\\\react-nodejs-chat\\\\client\\\\src\\\\page\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { SocketContext } from \"../context/socket\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Chat = () => {\n  _s();\n  const socket = useContext(SocketContext);\n  const [userName, setUserName] = useState(\"\");\n  const [roomId, setRoomId] = useState(\"\");\n  const [roomName, setRoomName] = useState(\"\");\n  const [capacity, setCapacity] = useState(\"\");\n  const [createDate, setCreateDate] = useState(\"\");\n  const [users, setUsers] = useState([]);\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const location = useLocation();\n  useEffect(() => {\n    const {\n      userName,\n      roomId\n    } = location.state;\n    setUserName(userName);\n    socket.emit(\"joinRoom\", {\n      userName,\n      roomId\n    });\n    socket.once(\"roomData\", _ref => {\n      let {\n        roomId,\n        roomName,\n        capacity,\n        createDate,\n        users\n      } = _ref;\n      setRoomId(roomId);\n      setRoomName(roomName);\n      setCapacity(capacity);\n      setCreateDate(createDate);\n      setUsers(users);\n      socket.on(\"roomData\", _ref2 => {\n        let {\n          users\n        } = _ref2;\n        setUsers(users);\n      });\n    });\n    socket.on(\"message\", _ref3 => {\n      let {\n        userName,\n        text\n      } = _ref3;\n      setMessages(prev => [...prev, `${userName} : ${text}`]);\n    });\n    return () => {\n      socket.emit(\"leaveRoom\");\n      socket.off(\"roomData\");\n      socket.off(\"message\");\n    };\n  }, []);\n  const sendMessage = () => {\n    if (message) {\n      socket.emit(\"sendMessage\", {\n        message\n      });\n      setMessage(\"\");\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\uB2C9\\uB124\\uC784: \", userName]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\uCC44\\uD305\\uBC29: \", roomName]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\uCC44\\uD305\\uBC29id: \", roomId]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\uAC1C\\uC124\\uC77C: \", createDate]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\uC778\\uC6D0: \", users.length, \" / \", capacity]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\uD604\\uC7AC \\uCC44\\uD305\\uBC29\\uC5D0 \\uC788\\uB294 \\uC0AC\\uB78C\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n      children: users.map((user, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n        children: user.userName\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"\\uCC44\\uD305\\uD558\\uAE30\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: messages.map((message, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: message\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      value: message,\n      onChange: e => setMessage(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: sendMessage,\n      children: \"\\uC804\\uC1A1\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s(Chat, \"nmdGFyaHBRXuNW33ed1NUXB8xKU=\", false, function () {\n  return [useLocation];\n});\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useContext","useLocation","SocketContext","Chat","socket","userName","setUserName","roomId","setRoomId","roomName","setRoomName","capacity","setCapacity","createDate","setCreateDate","users","setUsers","message","setMessage","messages","setMessages","location","state","emit","once","on","text","prev","off","sendMessage","length","map","user","index","e","target","value"],"sources":["D:/jisu/react-nodejs-chat/client/src/page/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { SocketContext } from \"../context/socket\";\r\n\r\nconst Chat = () => {\r\n  const socket = useContext(SocketContext);\r\n  const [userName, setUserName] = useState(\"\");\r\n  const [roomId, setRoomId] = useState(\"\");\r\n  const [roomName, setRoomName] = useState(\"\");\r\n  const [capacity, setCapacity] = useState(\"\");\r\n  const [createDate, setCreateDate] = useState(\"\");\r\n  const [users, setUsers] = useState([]);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [messages, setMessages] = useState([]);\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n    const { userName, roomId } = location.state;\r\n\r\n    setUserName(userName);\r\n\r\n    socket.emit(\"joinRoom\", { userName, roomId });\r\n\r\n    socket.once(\r\n      \"roomData\",\r\n      ({ roomId, roomName, capacity, createDate, users }) => {\r\n        setRoomId(roomId);\r\n        setRoomName(roomName);\r\n        setCapacity(capacity);\r\n        setCreateDate(createDate);\r\n        setUsers(users);\r\n\r\n        socket.on(\"roomData\", ({ users }) => {\r\n          setUsers(users);\r\n        });\r\n      }\r\n    );\r\n\r\n    socket.on(\"message\", ({ userName, text }) => {\r\n      setMessages((prev) => [...prev, `${userName} : ${text}`]);\r\n    });\r\n\r\n    return () => {\r\n      socket.emit(\"leaveRoom\");\r\n      socket.off(\"roomData\");\r\n      socket.off(\"message\");\r\n    };\r\n  }, []);\r\n\r\n  const sendMessage = () => {\r\n    if (message) {\r\n      socket.emit(\"sendMessage\", { message });\r\n      setMessage(\"\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <p>닉네임: {userName}</p>\r\n      <p>채팅방: {roomName}</p>\r\n      <p>채팅방id: {roomId}</p>\r\n      <p>개설일: {createDate}</p>\r\n      <p>\r\n        인원: {users.length} / {capacity}\r\n      </p>\r\n      <p>현재 채팅방에 있는 사람</p>\r\n      <ul>\r\n        {users.map((user, index) => (\r\n          <li key={index}>{user.userName}</li>\r\n        ))}\r\n      </ul>\r\n      <p>채팅하기</p>\r\n      <div>\r\n        <ul>\r\n          {messages.map((message, index) => (\r\n            <li key={index}>{message}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n      <input\r\n        type=\"text\"\r\n        value={message}\r\n        onChange={(e) => setMessage(e.target.value)}\r\n      />\r\n      <button type=\"button\" onClick={sendMessage}>\r\n        전송\r\n      </button>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}